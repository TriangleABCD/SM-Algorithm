#include <omp.h>
#include "sm4.h"
#include "sm3.h"

int main(int argc, char** argv) {
    SM3 sm3("011000010110001001100011");




    SM4 sm4(
           "00000001001000110100010101100111100010011010101111001101111011111111111011011100101110101001100001110110010101000011001000010000", 
           "00000001001000110100010101100111100010011010101111001101111011111111111011011100101110101001100001110110010101000011001000010000"
    );
    int cnt = atoi(argv[1]);
    sm4.genRK();
    std::string msg = "00000001001000110100010101100111100010011010101111001101111011111111111011011100101110101001100001110110010101000011001000010000";
    sm4.setMsg(msg);
    # pragma omp parallel for 
    for(int i = 0; i < cnt; ++i) {
        sm4.encrypt();
    }
    for(int i = 0; i < 4; ++i) {
        std::cout << sm4.Y[i].to_string() << "\n";
    }
    std::cout << "#\n";
    return 0;
}
